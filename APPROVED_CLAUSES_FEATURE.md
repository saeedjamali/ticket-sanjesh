# ویژگی بندهای موافقت شده (Approved Clauses Feature)

## مقدمه

این ویژگی امکان نمایش جزئیات بندهای موافقت شده را براساس کدهای ثبت شده در فیلد `approvedClauses` فراهم می‌کند.

## ساختار داده

- **فیلد approvedClauses**: رشته‌ای شامل کدهای بند جدا شده با علامت `+`
- **مثال**: `"1+2+9+16"`
- **اعتبارسنجی**: فقط اعداد و علامت `+` مجاز است

## کامپوننت‌های اضافه شده

### 1. API Endpoint: `/api/transfer-reasons/by-codes`

```
GET /api/transfer-reasons/by-codes?codes=1,2,9,16
```

**پاسخ:**

```json
{
  "success": true,
  "data": [
    {
      "code": "1",
      "title": "عنوان بند",
      "reasonTitle": "عنوان دلیل",
      "description": "توضیحات کامل بند",
      "order": 1
    }
  ],
  "total": 4
}
```

### 2. کامپوننت ApprovedClausesDisplay

**ویژگی‌ها:**

- پارس خودکار کدهای بند از رشته `approvedClauses`
- دریافت جزئیات از API
- نمایش کامل اطلاعات هر بند
- مدیریت حالت‌های loading و error

**استفاده:**

```jsx
import ApprovedClausesDisplay from "@/components/ApprovedClausesDisplay";

<ApprovedClausesDisplay
  approvedClauses="1+2+9+16"
  variant="detailed" // 'default', 'compact', 'detailed'
  className="bg-green-50 border border-green-200 rounded-lg p-4"
/>;
```

**انواع نمایش:**

- `compact`: فقط کدها
- `default`: کدها + جزئیات ساده
- `detailed`: کدها + جزئیات کامل

## نمایش در صفحه Emergency Transfer

### مکان‌های نمایش:

1. **بخش نتایج نهایی انتقال** (نمایش اصلی)
2. **بخش جزئیات درخواست** (نمایش ReadOnly)

### ویژگی‌های نمایش:

- **کدهای خام**: `1+2+9+11` (فونت monospace)
- **جزئیات بندها**: عنوان، عنوان دلیل، توضیحات
- **طراحی**: رنگ‌بندی مناسب برای هر بخش
- **وضعیت loading**: نمایش انیمیشن در حین دریافت داده‌ها
- **مدیریت خطا**: نمایش پیام‌های خطا مناسب

## مثال عملی

### ورودی:

```
approvedClauses: "1+2+9+16"
```

### خروجی نمایش:

```
🔵 بندهای موافقت شده:

کدها: [1+2+9+16]

جزئیات بندها:

┌─ بند 1 ──────────────────────────┐
│ کد بند: 1                         │
│ عنوان: همسر شاغل                 │
│ عنوان دلیل: مسائل خانوادگی        │
│ توضیحات: انتقال به دلیل اشتغال...│
└─────────────────────────────────┘

┌─ بند 2 ──────────────────────────┐
│ کد بند: 2                         │
│ عنوان: مسائل پزشکی               │
│ عنوان دلیل: درمان                │
│ توضیحات: نیاز به درمان تخصصی...  │
└─────────────────────────────────┘
```

## مزایا

1. **شفافیت**: نمایش دقیق دلایل موافقت
2. **قابلیت استفاده**: رابط کاربری واضح و ساده
3. **انعطاف‌پذیری**: امکان نمایش در حالت‌های مختلف
4. **کارایی**: دریافت هوشمند داده‌ها از API
5. **قابلیت توسعه**: آماده برای افزودن ویژگی‌های جدید

## نکات فنی

- **اعتبارسنجی**: بررسی فرمت کدها در سمت کلاینت و سرور
- **بهینه‌سازی**: دریافت داده‌ها فقط هنگام نیاز
- **مدیریت خطا**: نمایش پیام‌های مناسب برای خطاهای مختلف
- **Responsive**: سازگار با انواع دستگاه‌ها
- **Performance**: کش کردن نتایج برای عملکرد بهتر

## چگونگی کارکرد

1. کاربر فیلد `approvedClauses` را دریافت می‌کند (مثل `"1+2+9+16"`)
2. کامپوننت کدها را پارس می‌کند: `["1", "2", "9", "16"]`
3. درخواست API به `/api/transfer-reasons/by-codes?codes=1,2,9,16` ارسال می‌شود
4. سرور اطلاعات هر بند را از دیتابیس `TransferReason` دریافت می‌کند
5. جزئیات هر بند شامل `title`, `reasonTitle`, `description` نمایش داده می‌شود
6. نتیجه نهایی در قالب زیبا و کاربرپسند نمایش داده می‌شود
